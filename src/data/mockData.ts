import { Project, Task, Sector, TeamMember, PipelineStage, BusinessSegment, ProjectDocument } from '@/types';

export const sectors: Sector[] = ['Manufacturing', 'Energy', 'Oil and Gas', 'Commodity Trading'];

export const businessSegments: BusinessSegment[] = ['Industrial', 'Commercial', 'Government', 'Enterprise', 'SMB'];

export const sectorColors: Record<Sector, string> = {
  Manufacturing: 'bg-chart-1/20 text-chart-1',
  Energy: 'bg-chart-2/20 text-chart-2',
  'Oil and Gas': 'bg-chart-3/20 text-chart-3',
  'Commodity Trading': 'bg-chart-4/20 text-chart-4',
};

export const sectorIcons: Record<Sector, string> = {
  Manufacturing: 'ğŸ­',
  Energy: 'âš¡',
  'Oil and Gas': 'ğŸ›¢ï¸',
  'Commodity Trading': 'ğŸ“ˆ',
};

export const stageColors: Record<PipelineStage, string> = {
  initiation: 'bg-chart-5/20 text-chart-5',
  qualification: 'bg-chart-4/20 text-chart-4',
  proposal: 'bg-chart-1/20 text-chart-1',
  negotiation: 'bg-chart-3/20 text-chart-3',
  approval: 'bg-chart-2/20 text-chart-2',
  execution: 'bg-primary/20 text-primary',
  closure: 'bg-accent/20 text-accent',
};

const generateTasks = (projectId: string, count: number): Task[] => {
  const statuses: Task['status'][] = ['todo', 'in-progress', 'review', 'completed'];
  const priorities: Task['priority'][] = ['low', 'medium', 'high', 'urgent'];
  const assignees = ['Alex Chen', 'Maria Garcia', 'John Smith', 'Sarah Johnson', 'Mike Wilson'];
  
  return Array.from({ length: count }, (_, i) => ({
    id: `task-${projectId}-${i + 1}`,
    title: `Task ${i + 1} for project ${projectId}`,
    description: `This is a detailed description for task ${i + 1}`,
    status: statuses[Math.floor(Math.random() * statuses.length)],
    priority: priorities[Math.floor(Math.random() * priorities.length)],
    assignee: assignees[Math.floor(Math.random() * assignees.length)],
    dueDate: new Date(Date.now() + Math.random() * 30 * 24 * 60 * 60 * 1000).toISOString(),
    projectId,
    createdAt: new Date(Date.now() - Math.random() * 30 * 24 * 60 * 60 * 1000).toISOString(),
  }));
};

const generateDocuments = (count: number): ProjectDocument[] => {
  const types: ProjectDocument['type'][] = ['rfq', 'proposal', 'contract', 'supporting'];
  const names = [
    'RFQ-2024-001.pdf',
    'Technical_Proposal.docx',
    'Service_Agreement.pdf',
    'Site_Survey_Report.pdf',
    'Budget_Breakdown.xlsx',
    'Contract_v2.pdf',
  ];
  
  return Array.from({ length: count }, (_, i) => ({
    id: `doc-${i + 1}`,
    name: names[i % names.length],
    type: types[Math.floor(Math.random() * types.length)],
    url: '#',
    uploadedAt: new Date(Date.now() - Math.random() * 30 * 24 * 60 * 60 * 1000).toISOString(),
    uploadedBy: 'Alex Chen',
    size: Math.floor(Math.random() * 5000000) + 100000,
    source: Math.random() > 0.5 ? 'local' : 'onedrive',
  }));
};

export const projects: Project[] = [
  {
    id: 'proj-1',
    name: 'Automated Assembly Line Upgrade',
    description: 'Modernize the main assembly line with robotic automation and IoT sensors for real-time monitoring.',
    sector: 'Manufacturing',
    status: 'active',
    progress: 65,
    startDate: '2024-01-15',
    endDate: '2024-06-30',
    teamSize: 12,
    tasks: generateTasks('proj-1', 8),
    pipelineStage: 'negotiation',
    pipelineIntakeDate: '2024-01-10',
    clientName: 'TechManufacturing Co.',
    clientContact: 'contact@techmanufacturing.com',
    oem: 'Siemens',
    location: 'Lagos, Nigeria',
    expectedCloseDate: '2024-06-30',
    businessSegment: 'Industrial',
    product: 'Automation Systems',
    subProduct: 'Assembly Line Robotics',
    projectLeadId: 'member-1',
    assigneeId: 'member-3',
    channelPartner: 'AutoTech Partners',
    contractValueNGN: 150000000,
    contractValueUSD: 100000,
    marginPercentNGN: 25,
    marginPercentUSD: 25,
    marginValueNGN: 37500000,
    marginValueUSD: 25000,
    projectLeadComments: 'Client is very responsive. Expect to close within Q2.',
    documents: generateDocuments(3),
    lastStageUpdate: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000).toISOString(),
  },
  {
    id: 'proj-2',
    name: 'Solar Farm Installation',
    description: 'Deploy 500MW solar capacity across the eastern region facilities.',
    sector: 'Energy',
    status: 'active',
    progress: 40,
    startDate: '2024-02-01',
    endDate: '2024-09-15',
    teamSize: 25,
    tasks: generateTasks('proj-2', 12),
    pipelineStage: 'proposal',
    pipelineIntakeDate: '2024-01-25',
    clientName: 'GreenPower Corp',
    clientContact: 'projects@greenpower.com',
    oem: 'SunPower',
    location: 'Abuja, Nigeria',
    expectedCloseDate: '2024-09-15',
    businessSegment: 'Commercial',
    product: 'Renewable Energy',
    subProduct: 'Solar PV Systems',
    projectLeadId: 'member-2',
    assigneeId: 'member-4',
    channelPartner: 'SolarTech Nigeria',
    contractValueNGN: 750000000,
    contractValueUSD: 500000,
    marginPercentNGN: 18,
    marginPercentUSD: 18,
    marginValueNGN: 135000000,
    marginValueUSD: 90000,
    projectLeadComments: 'Large project, multiple stakeholders involved.',
    documents: generateDocuments(4),
    lastStageUpdate: new Date(Date.now() - 4 * 24 * 60 * 60 * 1000).toISOString(),
  },
  {
    id: 'proj-3',
    name: 'Offshore Drilling Platform',
    description: 'Deploy new drilling platform with advanced safety systems and environmental monitoring.',
    sector: 'Oil and Gas',
    status: 'active',
    progress: 80,
    startDate: '2023-11-01',
    endDate: '2024-04-30',
    teamSize: 35,
    tasks: generateTasks('proj-3', 15),
    pipelineStage: 'approval',
    pipelineIntakeDate: '2023-10-15',
    clientName: 'PetroNigeria',
    clientContact: 'ops@petronigeria.com',
    oem: 'Schlumberger',
    location: 'Port Harcourt, Nigeria',
    expectedCloseDate: '2024-04-30',
    businessSegment: 'Enterprise',
    product: 'Drilling Equipment',
    subProduct: 'Offshore Platform',
    projectLeadId: 'member-1',
    assigneeId: 'member-6',
    channelPartner: 'OilField Services Ltd',
    contractValueNGN: 2250000000,
    contractValueUSD: 1500000,
    marginPercentNGN: 12,
    marginPercentUSD: 12,
    marginValueNGN: 270000000,
    marginValueUSD: 180000,
    projectLeadComments: 'Final approvals pending from client board.',
    documents: generateDocuments(5),
    lastStageUpdate: new Date(Date.now() - 1 * 24 * 60 * 60 * 1000).toISOString(),
  },
  {
    id: 'proj-4',
    name: 'Fleet Management System',
    description: 'Implement GPS tracking and route optimization for the entire delivery fleet.',
    sector: 'Commodity Trading',
    status: 'active',
    progress: 55,
    startDate: '2024-03-01',
    endDate: '2024-07-31',
    teamSize: 8,
    tasks: generateTasks('proj-4', 6),
    pipelineStage: 'qualification',
    pipelineIntakeDate: '2024-02-20',
    clientName: 'SwiftTrading Co.',
    clientContact: 'tech@swifttrading.com',
    oem: 'TradeTech',
    location: 'Kano, Nigeria',
    expectedCloseDate: '2024-07-31',
    businessSegment: 'SMB',
    product: 'Trading Platform',
    subProduct: 'Commodity Analytics',
    projectLeadId: 'member-5',
    assigneeId: 'member-5',
    channelPartner: 'LogiTech Solutions',
    contractValueNGN: 45000000,
    contractValueUSD: 30000,
    marginPercentNGN: 30,
    marginPercentUSD: 30,
    marginValueNGN: 13500000,
    marginValueUSD: 9000,
    projectLeadComments: 'Qualification meeting scheduled for next week.',
    documents: generateDocuments(2),
    lastStageUpdate: new Date(Date.now() - 5 * 24 * 60 * 60 * 1000).toISOString(),
  },
  {
    id: 'proj-5',
    name: 'Quality Control Automation',
    description: 'Install AI-powered visual inspection systems on production lines.',
    sector: 'Manufacturing',
    status: 'on-hold',
    progress: 25,
    startDate: '2024-02-15',
    teamSize: 6,
    tasks: generateTasks('proj-5', 5),
    pipelineStage: 'initiation',
    pipelineIntakeDate: '2024-02-10',
    clientName: 'QualityFirst Industries',
    clientContact: 'procurement@qualityfirst.com',
    oem: 'Keyence',
    location: 'Ibadan, Nigeria',
    expectedCloseDate: '2024-08-31',
    businessSegment: 'Industrial',
    product: 'Quality Control',
    subProduct: 'AI Inspection',
    projectLeadId: 'member-3',
    assigneeId: 'member-3',
    contractValueNGN: 60000000,
    contractValueUSD: 40000,
    marginPercentNGN: 22,
    marginPercentUSD: 22,
    marginValueNGN: 13200000,
    marginValueUSD: 8800,
    projectLeadComments: 'On hold pending budget approval from client.',
    documents: generateDocuments(1),
    lastStageUpdate: new Date(Date.now() - 10 * 24 * 60 * 60 * 1000).toISOString(),
  },
  {
    id: 'proj-6',
    name: 'Wind Turbine Maintenance',
    description: 'Quarterly maintenance program for offshore wind turbine fleet.',
    sector: 'Energy',
    status: 'completed',
    progress: 100,
    startDate: '2024-01-01',
    endDate: '2024-03-31',
    teamSize: 15,
    tasks: generateTasks('proj-6', 10),
    pipelineStage: 'closure',
    pipelineIntakeDate: '2023-12-15',
    clientName: 'WindEnergy Nigeria',
    clientContact: 'maintenance@windenergy.ng',
    oem: 'Vestas',
    location: 'Lagos, Nigeria',
    expectedCloseDate: '2024-03-31',
    businessSegment: 'Commercial',
    product: 'Maintenance Services',
    subProduct: 'Wind Turbine',
    projectLeadId: 'member-4',
    assigneeId: 'member-4',
    channelPartner: 'TurbineCare Ltd',
    contractValueNGN: 120000000,
    contractValueUSD: 80000,
    marginPercentNGN: 20,
    marginPercentUSD: 20,
    marginValueNGN: 24000000,
    marginValueUSD: 16000,
    projectLeadComments: 'Successfully completed. Client satisfied.',
    documents: generateDocuments(4),
    lastStageUpdate: '2024-03-31T00:00:00Z',
  },
  {
    id: 'proj-7',
    name: 'Pipeline Infrastructure Upgrade',
    description: 'Modernize 200km of pipeline with smart sensors and leak detection systems.',
    sector: 'Oil and Gas',
    status: 'active',
    progress: 30,
    startDate: '2024-04-01',
    endDate: '2024-12-31',
    teamSize: 45,
    tasks: generateTasks('proj-7', 20),
    pipelineStage: 'proposal',
    pipelineIntakeDate: '2024-03-20',
    clientName: 'NNPC Subsidiary',
    clientContact: 'projects@nnpc-sub.com',
    oem: 'Baker Hughes',
    location: 'Warri, Nigeria',
    expectedCloseDate: '2024-12-31',
    businessSegment: 'Government',
    product: 'Pipeline Systems',
    subProduct: 'Smart Sensors',
    projectLeadId: 'member-2',
    assigneeId: 'member-6',
    channelPartner: 'PipelineTech Nigeria',
    contractValueNGN: 3000000000,
    contractValueUSD: 2000000,
    marginPercentNGN: 15,
    marginPercentUSD: 15,
    marginValueNGN: 450000000,
    marginValueUSD: 300000,
    projectLeadComments: 'Government project, extensive documentation required.',
    documents: generateDocuments(6),
    lastStageUpdate: new Date(Date.now() - 3 * 24 * 60 * 60 * 1000).toISOString(),
  },
  {
    id: 'proj-8',
    name: 'Cross-Border Shipping Expansion',
    description: 'Establish new logistics routes and partnerships for international shipping.',
    sector: 'Commodity Trading',
    status: 'active',
    progress: 15,
    startDate: '2024-05-01',
    endDate: '2024-11-30',
    teamSize: 10,
    tasks: generateTasks('proj-8', 8),
    pipelineStage: 'initiation',
    pipelineIntakeDate: '2024-04-25',
    clientName: 'GlobalCommodities Inc',
    clientContact: 'partnerships@globalcommodities.com',
    oem: 'TradeAxis',
    location: 'Lagos, Nigeria',
    expectedCloseDate: '2024-11-30',
    businessSegment: 'Enterprise',
    product: 'Trading Solutions',
    subProduct: 'International Markets',
    projectLeadId: 'member-5',
    assigneeId: 'member-5',
    contractValueNGN: 225000000,
    contractValueUSD: 150000,
    marginPercentNGN: 18,
    marginPercentUSD: 18,
    marginValueNGN: 40500000,
    marginValueUSD: 27000,
    projectLeadComments: 'Initial discussions ongoing.',
    documents: generateDocuments(2),
    lastStageUpdate: new Date(Date.now() - 1 * 24 * 60 * 60 * 1000).toISOString(),
  },
];

export const teamMembers: TeamMember[] = [
  {
    id: 'member-1',
    name: 'Alex Chen',
    email: 'alex.chen@industria.com',
    role: 'admin',
    department: 'Engineering',
    assignedProjects: ['proj-1', 'proj-2'],
    createdAt: '2023-01-15T00:00:00Z',
  },
  {
    id: 'member-2',
    name: 'Maria Garcia',
    email: 'maria.garcia@industria.com',
    role: 'editor',
    department: 'Operations',
    assignedProjects: ['proj-3', 'proj-4'],
    createdAt: '2023-03-20T00:00:00Z',
  },
  {
    id: 'member-3',
    name: 'John Smith',
    email: 'john.smith@industria.com',
    role: 'editor',
    department: 'Manufacturing',
    assignedProjects: ['proj-1', 'proj-5'],
    createdAt: '2023-05-10T00:00:00Z',
  },
  {
    id: 'member-4',
    name: 'Sarah Johnson',
    email: 'sarah.johnson@industria.com',
    role: 'viewer',
    department: 'Quality Control',
    assignedProjects: ['proj-2', 'proj-6'],
    createdAt: '2023-07-01T00:00:00Z',
  },
  {
    id: 'member-5',
    name: 'Mike Wilson',
    email: 'mike.wilson@industria.com',
    role: 'editor',
    department: 'Logistics',
    assignedProjects: ['proj-4', 'proj-8'],
    createdAt: '2023-09-15T00:00:00Z',
  },
  {
    id: 'member-6',
    name: 'Emily Davis',
    email: 'emily.davis@industria.com',
    role: 'viewer',
    department: 'Safety',
    assignedProjects: ['proj-3', 'proj-7'],
    createdAt: '2024-01-05T00:00:00Z',
  },
];

export const getProjectById = (id: string): Project | undefined => {
  return projects.find(p => p.id === id);
};

export const getProjectsBySector = (sector: Sector): Project[] => {
  return projects.filter(p => p.sector === sector);
};

export const getTeamMemberById = (id: string): TeamMember | undefined => {
  return teamMembers.find(m => m.id === id);
};

export const getDashboardStats = () => {
  const allTasks = projects.flatMap(p => p.tasks);
  const now = new Date();
  
  return {
    totalProjects: projects.length,
    activeProjects: projects.filter(p => p.status === 'active').length,
    completedTasks: allTasks.filter(t => t.status === 'completed').length,
    pendingTasks: allTasks.filter(t => t.status !== 'completed').length,
    overdueTasks: allTasks.filter(t => t.dueDate && new Date(t.dueDate) < now && t.status !== 'completed').length,
  };
};

// Check for projects with inactivity > 3 days
export const getInactiveProjects = (): Project[] => {
  const threeDaysAgo = new Date(Date.now() - 3 * 24 * 60 * 60 * 1000);
  return projects.filter(p => 
    p.status === 'active' && 
    p.lastStageUpdate && 
    new Date(p.lastStageUpdate) < threeDaysAgo &&
    p.pipelineStage !== 'closure'
  );
};
